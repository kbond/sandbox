<ul class="thumbnails">
    {% if manager.path %}
        <li class="span2">
            {{ _self.thumbnail(path('zenstruck_media_list', manager.requestParams({ 'path': manager.previousPath })), '...', asset('bundles/zenstruckmedia/images/icons/up.png')) }}
        </li>
    {% endif %}
    {% for file in manager.files %}
        <li class="span2">
            {% if file.isDir %}
                {% set image = asset('bundles/zenstruckmedia/images/icons/folder.png') %}
                {% set src = path('zenstruck_media_list', manager.requestParams({ 'path': manager.path ~ '/' ~ file.getFilename })) %}
            {% else %}
                {% set src = '' %}
                {% if file.isImage %}
                    {% set image = file.webPath %}
                {% else %}
                    {% set image = asset('bundles/zenstruckmedia/images/icons/file.png') %}
                {% endif %}
            {% endif %}

            {{ _self.thumbnail(src, file.getFilename, image) }}
        </li>
    {% else %}
        <li class="span2"><em>No Files</em></li>
    {% endfor %}
</ul>

{% macro thumbnail(src, filename, image) %}
    <a href="{{ src }}" title="{{ filename }}" class="thumbnail">
                <span class="zenstruck-media-thumbnail-container">
                    <span>
                        <img src="{{ image }}" />
                    </span>
                </span>
        <span class="zenstruck-media-thumbnail-caption">{{ filename }}</span>
    </a>
{% endmacro %}